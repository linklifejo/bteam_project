<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="lo">

<!-- 신규고객정보 삽입저장 -->
<insert id='insert'>
insert into location( locname, name_desc, latitude,longitude, post, address)
values (#{locname}, #{name_desc}, #{latitude}, #{longitude}, #{post}, #{address})
</insert>

<!-- 해당고객정보 수정저장 -->
<update id='update'>
update location
set locname = #{locname}, name_desc = #{name_desc}, latitude = #{latitude}, longitude = #{longitude}, post = #{post}, address = #{address}
where id = #{id}
</update>

<!-- 해당고객정보 삭제 -->
<delete id='delete'>
delete from location where id = #{id}
</delete>

<!-- 산정보및 서울/경기정보조회 -->
<select id='info' resultType='location.LocationVO'>
select * from location where id = #{id}
</select>
<!-- 지역별 산 정보조회 -->
<select id='local_list' resultType='location.LocationVO'>
select * from location where address like '%#{add}%'
</select>

<!-- 고객목록조회 -->
<select id='list' resultType='location.LocationVO'>
select * from location order by locname
</select>

<!-- 총 글의 건수 조회 -->
<select id='totalCount' resultType='integer'>
select * from location where address like '%' || #{add} || '%'
</select>

<sql id='search_where'>
<choose>
<when test=" search=='all' ">
where title like '%' || #{keyword} || '%'
or    content like '%' || #{keyword} || '%'
or    <include refid="search_writer"/>
</when>
<when test=" search=='title' or search=='content' ">
where ${search} like '%' || #{keyword} || '%'
</when>
<when test=" search=='writer' ">
where <include refid="search_writer"/>
</when>
</choose>
</sql>

<sql id='search_writer'>
writer in (select id from member where name like '%' || #{keyword} || '%')
</sql>


</mapper>  